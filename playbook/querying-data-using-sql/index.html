<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/Data-Platform-Playbook/blog/rss.xml" title="Hackney Data Platform Playbook Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Data-Platform-Playbook/blog/atom.xml" title="Hackney Data Platform Playbook Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Hackney Data Platform Playbook" href="/Data-Platform-Playbook/opensearch.xml"><title data-react-helmet="true">Querying the Platform using SQL | Hackney Data Platform Playbook</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Querying the Platform using SQL | Hackney Data Platform Playbook"><meta data-react-helmet="true" name="description" content="AWS Athena to query data in S3"><meta data-react-helmet="true" property="og:description" content="AWS Athena to query data in S3"><meta data-react-helmet="true" property="og:url" content="https://playbook.hackney.gov.uk/Data-Platform-Playbook//Data-Platform-Playbook/playbook/querying-data-using-sql"><link data-react-helmet="true" rel="shortcut icon" href="/Data-Platform-Playbook/img/favicon.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://playbook.hackney.gov.uk/Data-Platform-Playbook//Data-Platform-Playbook/playbook/querying-data-using-sql"><link rel="stylesheet" href="/Data-Platform-Playbook/styles.2116970b.css">
<link rel="stylesheet" href="/Data-Platform-Playbook/main.4a16e2e4.css">
<link rel="preload" href="/Data-Platform-Playbook/styles.c38d258b.js" as="script">
<link rel="preload" href="/Data-Platform-Playbook/runtime~main.5b419c8b.js" as="script">
<link rel="preload" href="/Data-Platform-Playbook/main.e67c3367.js" as="script">
<link rel="preload" href="/Data-Platform-Playbook/1.043deba2.js" as="script">
<link rel="preload" href="/Data-Platform-Playbook/2.0b5f0ece.js" as="script">
<link rel="preload" href="/Data-Platform-Playbook/51.0dd2dc44.js" as="script">
<link rel="preload" href="/Data-Platform-Playbook/54.80eba4cd.js" as="script">
<link rel="preload" href="/Data-Platform-Playbook/935f2afb.7f448e25.js" as="script">
<link rel="preload" href="/Data-Platform-Playbook/17896441.ddb476a2.js" as="script">
<link rel="preload" href="/Data-Platform-Playbook/8000a544.933f8424.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/Data-Platform-Playbook/"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Data Platform Playbook</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LBHackney-IT/data-platform-playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/Data-Platform-Playbook/"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/Data-Platform-Playbook/img/logo-long.svg" alt="Data Platform Playbook" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Data Platform Playbook</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/LBHackney-IT/data-platform-playbook" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/Data-Platform-Playbook/release-notes">Release Notes</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/zones">Zones</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/environments">Environments</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Playbook</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/connecting-to-redshift-from-data-studio">Connecting to the redshift cluster from Google Data Studio</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/exporting-snapshot-to-landing-zone">Exporting database snapshot to the Data Platform Landing Zone</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/google-sheets-import">Google Sheets import</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/import-files-from-google-to-S3">Import files from google to s3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/import-xlsx-from-g-drive">Import XLXS from G Drive</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/ingest-data-from-csv-files">Ingest manually uploaded csv files</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/Data-Platform-Playbook/playbook/querying-data-using-sql">Querying the Platform using SQL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/scheduling-liberator-glue-jobs">Scheduling Liberator Glue Jobs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/playbook/using-glue-studio">Using Glue Studio</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Data-Platform-Playbook/workshop/aws_glue_studio_parking">Glue Studio workshop with Parking Analysts</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Technical Documentation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/docs/docs">Docs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/docs/exporting-snapshot-to-landing-zone">Exporting database snapshots to the Data Platform Landing Zone</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/docs/import-xlsx-from-g-drive">Import XLXS from G Drive</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/docs/vpc-peering-connection-dataplatform-and-production-apis-account">VPC Peering Connection between Data Platform and Production APIs AWS accounts</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Architecture Decision</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/architecture-decisions/index">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Records</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/architecture-decisions/0001-record-architecture-decisions">Record architecture decisions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/architecture-decisions/0002-ingest-google-sheets-data">Ingest Google Sheets Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/architecture-decisions/0003-role-based-access-control">Role-Based Access Control</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/architecture-decisions/0004-partition-strategy">Partition Strategy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/architecture-decisions/0005-recovered-data">Recovered Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/architecture-decisions/0006-ingest-sql-flat-files">Ingest SQL flat files</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/architecture-decisions/0007-sftp-to-s3-lambda">Copy Liberator data from sftp to s3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/architecture-decisions/0008-production-data-in-staging">production-data-in-staging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/architecture-decisions/0009-ingesting-data-from-apis">Ingesting data from APIs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/architecture-decisions/index">Introduction</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Spikes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/spikes/0001-ingest-google-sheet-data">Ingesting Google Sheet Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/spikes/0002-use-of-lake-formation-to-enforce-rbac">Use of Lake Formation to enforce Role-Based Access Control (RBAC) to tools such as Athena</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/spikes/0003-ingest-base-uprn-data">Ingest base UPRN data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/spikes/0004-use-of-ous-to-provide-intra-bucket-rbac">Use of Organisational Units to provide intra bucket Role-Based Access Control</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/spikes/0005-qlik-integration">Qlik Integration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/spikes/0006-review-fme-and-glue-capabilities">Qlik Integration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Data-Platform-Playbook/spikes/0007-datahub-deployment">Datahub deployment</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Querying the Platform using SQL</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="intro"></a>Intro<a class="hash-link" href="#intro" title="Direct link to heading">#</a></h2><p>The Data Platform provides AWS Athena as the tool to execute SQL queries against the data within the platform.</p><p>AWS Athena is built on top of Presto, and we&#x27;re using Athena engine version 2.
AWS provide <a href="https://docs.aws.amazon.com/athena/latest/ug/presto-functions.html" target="_blank" rel="noopener noreferrer">documenation on what functions</a> they make available as part of their <a href="https://docs.aws.amazon.com/athena/latest/ug/ddl-sql-reference.html" target="_blank" rel="noopener noreferrer">SQL reference</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="logging-into-athena"></a>Logging into Athena<a class="hash-link" href="#logging-into-athena" title="Direct link to heading">#</a></h2><p>After logging into the Data Platform AWS account, navigate to Athena using the AWS console.</p><p><img alt="Searching for Athena in the AWS navigation bar" src="/Data-Platform-Playbook/assets/images/navigate-athena-f1a8c31818223bd10c26c33e9d2e6d2d.png"></p><p>You&#x27;ll want to make sure that your region is currently set to London, in AWS this is achieved using the region selector as shown below.</p><p><img alt="AWS Console region selector" src="/Data-Platform-Playbook/assets/images/region-selector-46ef6caf1f7a96986fd27de3f0da463c.png"></p><p>Then you&#x27;ll want to ensure that you are switched to the Athena Workgroup you were given during your onboarding.
You can check your current workgroup by hovering over the workgroup tab displayed at the top of the Athena page.
If the workgroup isn&#x27;t correct then <a href="https://docs.aws.amazon.com/athena/latest/ug/workgroups-create-update-delete.html#switching-workgroups" target="_blank" rel="noopener noreferrer">switch your workgroup</a> to the one you were given before proceeding.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="running-queries"></a>Running queries<a class="hash-link" href="#running-queries" title="Direct link to heading">#</a></h2><p>From the &quot;Query editor&quot; you should have access to a number of tables, from which you can construct and execute queries.</p><p><img alt="AWS Athena query editor" src="/Data-Platform-Playbook/assets/images/query-athena-8fdc548739748041aab9663f8df9aea1.png"></p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/LBHackney-IT/data-platform-playbook/edit/master/docs/playbook/querying-data-using-sql.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Data-Platform-Playbook/playbook/ingest-data-from-csv-files"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Ingest manually uploaded csv files</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Data-Platform-Playbook/playbook/scheduling-liberator-glue-jobs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Scheduling Liberator Glue Jobs Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#intro" class="table-of-contents__link">Intro</a></li><li><a href="#logging-into-athena" class="table-of-contents__link">Logging into Athena</a></li><li><a href="#running-queries" class="table-of-contents__link">Running queries</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Made by HackIT.</div></div></div></footer></div>
<script src="/Data-Platform-Playbook/styles.c38d258b.js"></script>
<script src="/Data-Platform-Playbook/runtime~main.5b419c8b.js"></script>
<script src="/Data-Platform-Playbook/main.e67c3367.js"></script>
<script src="/Data-Platform-Playbook/1.043deba2.js"></script>
<script src="/Data-Platform-Playbook/2.0b5f0ece.js"></script>
<script src="/Data-Platform-Playbook/51.0dd2dc44.js"></script>
<script src="/Data-Platform-Playbook/54.80eba4cd.js"></script>
<script src="/Data-Platform-Playbook/935f2afb.7f448e25.js"></script>
<script src="/Data-Platform-Playbook/17896441.ddb476a2.js"></script>
<script src="/Data-Platform-Playbook/8000a544.933f8424.js"></script>
</body>
</html>